var path = require('path');
var util = require('util');
var expect = require('expect.js');
var ittfhelper = require('../helpers/ittfhelper');

var ModelProvider = require('../../lib/ittf/provider');
var includer = require('../../lib/ittf/includer');

var root;

describe("the includer includes ittf document as is", function () {

    before(function (done) {
        var content_filepath = path.join(__dirname, 'data', 'includer_1.ittf');
        var provider = ModelProvider.createFromFilepath(content_filepath, {});
        provider.get({
            from: 'store',
            filepath: provider.getPrimaryModelFilepath()
        }, function (err, ittfModel) {
            includer(ittfModel, provider, function (err, includedModel) {
                root = includedModel.nodes[0];
                console.log('includer.includedModel', util.inspect(root, { depth: 2 }));
                done();
            });
        });
    })

    it('should be a test.2.beta.0.sub.$.2-1', function () {

        var result = ittfhelper.matchPath2("test.1.beta.0.sub.$.2-1", root)
        expect(result).to.be(true)

    });

});

